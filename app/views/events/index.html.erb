<%= content_for :body_attributes %>

<h2>Upcoming Conferences</h2>


<table class="conferencetable">
  <tr>
    <th>Name</th>
    <th></th>

    <th>Date</th>
    <th>Precis Deadline</th>
    <th>Paper Deadline</th>
    <th>Location</th>
    <th>People</th>
    <th></th>
  </tr>

<% @events.each do |event| %>
  <tr>
	<td><%= link_to truncate(event.name, :length => 20), event, :title => event.nameLong %> <%= ispeerreviewed(event) %>
	</td>
	
	<td>
		<div class="btn-group">
		    <button class="btn btn-default btn-xs dropdown-toggle" type="button" data-toggle="dropdown">
				 more <span class="caret"></span>
			</button>
			<ul class="dropdown-menu">
				<li><%= link_to 'Conference Website', event.conferenceurl %></li>
				<li><% unless event.callforpapersurl.empty? %> <%= link_to 'CfP', event.callforpapersurl %> <% end %> </li>
				<li><%= link_to 'add to iCal', { :id => event, :controller => 'events', :action => 'show', :format => :ics} %></li>
				
			</ul>
		</div>
	</td>
    <td><%= duration(event) %></td>
<% if event.precisdeadline < Date.today %>
	<td style="text-decoration: line-through;"><%= precisdeadline(event) %></td>
<% else %>
	<td style="color:rgb(<%= (event.precisdeadline - Date.today).to_i*-(255/90)+255 %>,0,0)">
		<%= precisdeadline(event) %>		
	</td>
<% end %>

<% if event.fullpaperdeadline < Date.today %>
	<td style="text-decoration: line-through;"><%= fullpaperdeadline(event) %></td>
<% else %>
	<td style="color:rgb(<%= (event.fullpaperdeadline - Date.today).to_i*-(255/90)+255 %>,0,0)">
		<%= fullpaperdeadline(event) %>
	</td>
<% end %>
    <td><%= truncate(event.address, :length => 20) %></td>
	<td><span class="badge"><%= event.attendances.count  %></span></td>
	
    <td style="float:right">
		<div class="btn-toolbar" role="toolbar">
	      <div class="btn-group-xs">
			<%= link_to edit_event_path(event), class: "btn btn-default" do %>
			    <i class="glyphicon glyphicon-pencil"></i>
			<% end %>  
			<%= link_to event, method: :delete, data: { confirm: 'Are you sure?' } , class: "btn btn-default" do %>
			    <i class="glyphicon glyphicon-trash"></i>
			<% end %>
	      </div>
	    </div>
	
   
	
	</td>
  </tr>
<% end %>

</table>

<h2>Past Conferences</h2>

<table class="conferencetable">
  <tr>
    <th>Name</th>
    <th>Date</th>
    <th></th>
    <th></th>
    <th>Location</th>
    <th></th>
  </tr>

<% @past.each do |event| %>
  <tr>
    <td><%= link_to event.name, event.conferenceurl %></td>
    <td><%= duration(event) %></td>
	<td></td>
	<td></td>
    <td><%= event.address %></td>
    <td style="float:right"><%= link_to 'Details', event, :class => "tiny_button" %>
    <%= link_to 'Edit', edit_event_path(event), :class => "tiny_button" %>
    <%= link_to 'Destroy', event, method: :delete, data: { confirm: 'Are you sure?' }, :class => "tiny_button_red"%></td>
  </tr>
<% end %>

</table>
<div class="pagination">
	<%= will_paginate @past, :param_name => 'past_page' %>
</div>

<br />

<h2>Tags</h2>
<div id="tag_cloud">
  <% tag_cloud Event.tag_counts, %w{s m l} do |tag, css_class| %>
    <%= link_to tag.name, tag_path(tag.name), class: css_class %>
  <% end %>
</div>